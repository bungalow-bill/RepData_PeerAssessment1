<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta name="generator" content="pandoc" />



<title></title>

<script src="PA1_template_files/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="PA1_template_files/bootstrap-2.3.2/css/united.min.css" rel="stylesheet" />
<link href="PA1_template_files/bootstrap-2.3.2/css/bootstrap-responsive.min.css" rel="stylesheet" />
<script src="PA1_template_files/bootstrap-2.3.2/js/bootstrap.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="container-fluid main-container">




<div id="reproducible-research-peer-assessment-1" class="section level1">
<h1>Reproducible Research: Peer Assessment 1</h1>
<p>Author: David Currie<br />Date: July 19, 2014<br />This assignment makes use of data from a personal activity monitoring device. This device collects data at 5 minute intervals through out the day. The data consists of two months of data from an anonymous individual collected during the months of October and November, 2012 and include the number of steps taken in 5 minute intervals each day.</p>
<div id="loading-and-preprocessing-the-data" class="section level2">
<h2>Loading and preprocessing the data</h2>
<p>The first step is to load and condition the data for analysis. The input data is contained in a zip archive, so we will extract it to a comma separated value (.csv) file then load it into a data.frame object. For ease of analysis, the date and interval fields are combined and converted to a POSIX date field.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(lubridate)
<span class="kw">library</span>(scales)

if(!<span class="kw">file.exists</span>(<span class="st">&#39;activity.csv&#39;</span>)){
  <span class="kw">unzip</span>(<span class="st">&#39;activity.zip&#39;</span>)
}
activity.dat&lt;-<span class="kw">read.csv</span>(<span class="st">&#39;activity.csv&#39;</span>)
<span class="co"># make some date related fields to help with plotting</span>
activity.dat$Date&lt;-<span class="kw">as.Date</span>(activity.dat$date)
activity.dat$posdate&lt;-<span class="kw">as.POSIXct</span>(<span class="kw">strptime</span>(<span class="kw">paste</span>(activity.dat$date,<span class="kw">sprintf</span>(<span class="st">&quot;%04d&quot;</span>,activity.dat$interval),<span class="dt">sep=</span><span class="st">&quot;-&quot;</span>),<span class="st">&quot;%Y-%m-%d-%H%M&quot;</span>))
activity.dat$wday&lt;-<span class="kw">wday</span>(activity.dat$posdate,<span class="dt">label=</span><span class="ot">TRUE</span>)
<span class="co"># the interval value is actually a time, but if it is interpreted as an integer, the plots are wrong</span>
<span class="co"># make a time of day field</span>
activity.dat$tod&lt;-activity.dat$posdate
<span class="kw">year</span>(activity.dat$tod)&lt;-<span class="dv">2010</span>
<span class="kw">yday</span>(activity.dat$tod)&lt;-<span class="dv">1</span></code></pre>
</div>
<div id="what-is-the-mean-total-number-of-steps-taken-per-day" class="section level2">
<h2>What is the mean total number of steps taken per day?</h2>
<p>The following graph shows a histogram of the total number of steps taken each day of the 61 days in the dataset.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># compute the sums for each day, excluding the NA values</span>
step.sums&lt;-<span class="kw">sapply</span>(<span class="kw">unique</span>(activity.dat$date),<span class="dt">FUN=</span>function(x) <span class="kw">sum</span>(activity.dat[activity.dat$date==x,<span class="st">&#39;steps&#39;</span>],<span class="dt">rm.na=</span><span class="ot">TRUE</span>))
<span class="co"># calculate the summary statistics</span>
step.mean&lt;-<span class="kw">mean</span>(step.sums,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)
step.median&lt;-<span class="kw">median</span>(step.sums,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)
<span class="co"># make a dataframe for plotting</span>
summary.df&lt;-<span class="kw">data.frame</span>(<span class="dt">Date=</span><span class="kw">as.Date</span>(<span class="kw">unique</span>(activity.dat$date)),<span class="dt">Steps=</span>step.sums)
<span class="co"># use ggplot to plot the histogram</span>
hplt&lt;-<span class="kw">ggplot</span>(summary.df)
hplt+<span class="kw">stat_bin</span>(<span class="dt">binwidth=</span><span class="dv">1000</span>,<span class="kw">aes</span>(<span class="dt">x=</span>Steps),<span class="dt">colour=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">fill=</span><span class="st">&#39;white&#39;</span>)+
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Histogram of Total Steps Per Day&#39;</span>)+
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span>step.mean,<span class="dt">colour=</span><span class="st">&#39;red&#39;</span>)+
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;Frequency (days)&#39;</span>)+
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&#39;Total Steps Per Day&#39;</span>)+
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="dt">label=</span><span class="kw">sprintf</span>(<span class="st">&#39;Mean = %5.1f&#39;</span>,step.mean),<span class="dt">x=</span>step.mean,<span class="dt">y=</span><span class="dv">3</span>,<span class="dt">angle=</span><span class="dv">90</span>,<span class="dt">vjust=</span>-.<span class="dv">5</span>,<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>,<span class="dt">size=</span><span class="dv">4</span>)+
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span>step.median,<span class="dt">colour=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>)+
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="dt">label=</span><span class="kw">sprintf</span>(<span class="st">&#39;Median = %5.1f&#39;</span>,step.median),<span class="dt">x=</span>step.median,<span class="dt">y=</span><span class="dv">7</span>,<span class="dt">angle=</span><span class="dv">90</span>,<span class="dt">vjust=</span>-.<span class="dv">5</span>,<span class="dt">colour=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">size=</span><span class="dv">4</span>)</code></pre>
<p><img src="PA1_template_files/figure-html/histogram.png" title="plot of chunk histogram" alt="plot of chunk histogram" width="768" /></p>
<p>The above graph indicates that the most common number of steps in a day was between 10000 and 11000, with 10 days reporting totals in that range. There were two days with total number of steps in excess of 20000 but also two days with 1000 or fewer steps. The distribution appears to be normal, with mean and median effectively equal.<br />Mean number of steps per day: 10767<br />Median number of steps per day: 10766</p>
<hr />
<p>Note to reviewers: the statistics quoted above are computed in the previous code chunk and generated in the text using inline R code. This code is not echoed when the markdown is rendered. I use this technique later in the report as well.</p>
<hr />
</div>
<div id="what-is-the-average-daily-activity-pattern" class="section level2">
<h2>What is the average daily activity pattern?</h2>
<p>The following figure shows the average number of steps reported in each 5 minute interval throughout the day.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># compute the means for each interval</span>
int.means.df&lt;-<span class="kw">data.frame</span>(<span class="dt">Interval=</span><span class="kw">unique</span>(activity.dat$tod), <span class="dt">Steps=</span><span class="kw">sapply</span>(<span class="kw">unique</span>(activity.dat$interval),<span class="dt">FUN=</span>function(x) <span class="kw">mean</span>(activity.dat[activity.dat$interval==x,<span class="st">&#39;steps&#39;</span>],<span class="dt">na.rm=</span><span class="ot">TRUE</span>)),<span class="dt">int=</span><span class="kw">unique</span>(activity.dat$interval))
<span class="co"># find the interval corresponding to the maximum reading</span>
max.int&lt;-int.means.df[<span class="kw">which.max</span>(int.means.df$Steps),]

pplt&lt;-<span class="kw">ggplot</span>(int.means.df,<span class="kw">aes</span>(<span class="dt">x=</span>Interval,<span class="dt">y=</span>Steps))
pplt+<span class="kw">geom_line</span>()+<span class="kw">scale_x_datetime</span>(<span class="dt">labels =</span> <span class="kw">date_format</span>(<span class="st">&quot;%H:%M&quot;</span>))+<span class="kw">xlab</span>(<span class="st">&quot;Time of Day&quot;</span>)+<span class="kw">ylab</span>(<span class="st">&quot;Average Number of Steps&quot;</span>)+
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Average Daily Pattern&quot;</span>)+
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">colour=</span><span class="st">&quot;Max&quot;</span>,<span class="dt">linetype=</span><span class="st">&quot;Max&quot;</span>),<span class="dt">xintercept=</span><span class="kw">as.numeric</span>(max.int[<span class="dv">1</span>,<span class="dv">1</span>]),<span class="dt">colour=</span><span class="st">&#39;red&#39;</span>,<span class="dt">linetype=</span><span class="st">&quot;longdash&quot;</span>)+
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="dt">label=</span><span class="kw">format</span>(max.int[<span class="dv">1</span>,<span class="dv">1</span>],<span class="st">&quot;%H:%M&quot;</span>),<span class="dt">x=</span>max.int[<span class="dv">1</span>,<span class="dv">1</span>],<span class="dt">y=</span><span class="dv">20</span>,<span class="dt">angle=</span><span class="dv">90</span>,<span class="dt">vjust=</span>-.<span class="dv">5</span>,<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>,<span class="dt">size=</span><span class="dv">4</span>)</code></pre>
<p><img src="PA1_template_files/figure-html/daily_pattern.png" title="plot of chunk daily_pattern" alt="plot of chunk daily_pattern" width="768" /></p>
<p>As illustrated by the dashed red line, the time interval that had the highest average number of steps was 08:35 which had an average number of steps equal to 206.1698</p>
</div>
<div id="imputing-missing-values" class="section level2">
<h2>Imputing missing values</h2>
<p>The original dataset is missing data from some days. In this section we will attempt to use a simple algorithm to estimate a value to be used in these instances. First, we will determine how much data is missing and how it is distributed. The following figure illustrates the total number of steps reported for each day in the duration of the dataset.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the number of rows with missing data</span>
missing.count&lt;-<span class="kw">sum</span>(<span class="kw">is.na</span>(activity.dat$steps))
<span class="co"># the days with missing data</span>
missing.dates&lt;-<span class="kw">unique</span>(activity.dat[<span class="kw">which</span>(<span class="kw">is.na</span>(activity.dat$steps)),<span class="st">&#39;Date&#39;</span>])
<span class="co"># the number of observations on the days with missing data</span>
missing.obs&lt;-<span class="kw">sapply</span>(missing.dates,<span class="dt">FUN=</span>function(x) <span class="kw">sum</span>(!<span class="kw">is.na</span>(activity.dat[activity.dat$Date==x,<span class="st">&#39;steps&#39;</span>])))

hplt+<span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Date,<span class="dt">y=</span>Steps),<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)+<span class="kw">ggtitle</span>(<span class="st">&#39;Total Steps Per Day&#39;</span>)</code></pre>
<pre><code>## Warning: Removed 8 rows containing missing values (position_stack).</code></pre>
<p><img src="PA1_template_files/figure-html/missing_data.png" title="plot of chunk missing_data" alt="plot of chunk missing_data" width="768" /></p>
<p>There appear to be 2304 rows with missing data, which occur on 8 separate dates. checking the data for those dates we find that they are missing data for all intervals in the day. Using the previously calculated average values for each interval, we can <em>fill in</em> the missing values according to the interval in which they occur. Using this approach, the histogram of total steps per day, shown below, differs from the original in that the bin containing the mean indicates an additional 8 days.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># make a copy of the original data</span>
filled.dat&lt;-activity.dat
<span class="co"># figure out which rows need to be updates</span>
tobe.filled&lt;-<span class="kw">which</span>(<span class="kw">is.na</span>(filled.dat$steps))
<span class="co"># replace the NA value with the average for that interval</span>
filled.dat[tobe.filled,<span class="st">&#39;steps&#39;</span>]&lt;-<span class="kw">sapply</span>(filled.dat[tobe.filled,<span class="st">&#39;interval&#39;</span>],<span class="dt">FUN=</span>function(x) <span class="kw">as.integer</span>(int.means.df[int.means.df$int==x,<span class="dv">2</span>]))
<span class="co"># plot the histogram</span>
filled.sums&lt;-<span class="kw">sapply</span>(<span class="kw">unique</span>(filled.dat$date),<span class="dt">FUN=</span>function(x) <span class="kw">sum</span>(filled.dat[filled.dat$date==x,<span class="st">&#39;steps&#39;</span>],<span class="dt">na.rm=</span><span class="ot">TRUE</span>))
filled.mean&lt;-<span class="kw">mean</span>(filled.sums,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)
filled.median&lt;-<span class="kw">median</span>(filled.sums,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)
filled.summary.df&lt;-<span class="kw">data.frame</span>(<span class="dt">Date=</span><span class="kw">as.Date</span>(<span class="kw">unique</span>(filled.dat$date)),<span class="dt">Steps=</span>filled.sums)
filled.hplt&lt;-<span class="kw">ggplot</span>(filled.summary.df)
filled.hplt+<span class="kw">stat_bin</span>(<span class="dt">binwidth=</span><span class="dv">1000</span>,<span class="kw">aes</span>(<span class="dt">x=</span>Steps),<span class="dt">colour=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">fill=</span><span class="st">&#39;white&#39;</span>)+
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Histogram of Total Steps Per Day: After Filling Missing Values&#39;</span>)+
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span>filled.mean,<span class="dt">colour=</span><span class="st">&#39;red&#39;</span>)+
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;Frequency (days)&#39;</span>)+
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&#39;Total Steps Per Day&#39;</span>)+
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="dt">label=</span><span class="kw">sprintf</span>(<span class="st">&#39;Mean = %5.1f&#39;</span>,filled.mean),<span class="dt">x=</span>filled.mean,<span class="dt">y=</span><span class="dv">5</span>,<span class="dt">angle=</span><span class="dv">90</span>,<span class="dt">vjust=</span>-.<span class="dv">5</span>,<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>,<span class="dt">size=</span><span class="dv">4</span>)+
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span>filled.median,<span class="dt">colour=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">linetype=</span><span class="st">&quot;longdash&quot;</span>)+
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="dt">label=</span><span class="kw">sprintf</span>(<span class="st">&#39;Median = %5.1f&#39;</span>,filled.median),<span class="dt">x=</span>filled.median,<span class="dt">y=</span><span class="dv">10</span>,<span class="dt">angle=</span><span class="dv">90</span>,<span class="dt">vjust=</span>-.<span class="dv">5</span>,<span class="dt">colour=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">size=</span><span class="dv">4</span>)</code></pre>
<p><img src="PA1_template_files/figure-html/fill_data.png" title="plot of chunk fill_data" alt="plot of chunk fill_data" width="768" /></p>
<p>Looking at the mean and median values, there is a small change;</p>
<table>
<thead>
<tr class="header">
<th align="left">Statistic</th>
<th align="left">Original</th>
<th align="left">Filled</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mean</td>
<td align="left">10767</td>
<td align="left">10750</td>
</tr>
<tr class="even">
<td align="left">Median</td>
<td align="left">10766</td>
<td align="left">10641</td>
</tr>
</tbody>
</table>
<p>Comparing the daily pattern, we can see there is no change from the un-filled dataset, which is what we would expect since this is the data used to replace the missing values.</p>
<pre class="sourceCode r"><code class="sourceCode r">filled.means.df&lt;-<span class="kw">data.frame</span>(<span class="dt">Interval=</span><span class="kw">unique</span>(filled.dat$tod), 
                            <span class="dt">Steps=</span><span class="kw">sapply</span>(<span class="kw">unique</span>(filled.dat$interval),<span class="dt">FUN=</span>function(x) <span class="kw">mean</span>(filled.dat[filled.dat$interval==x,<span class="st">&#39;steps&#39;</span>],<span class="dt">na.rm=</span><span class="ot">TRUE</span>)),
                            <span class="dt">int=</span><span class="kw">unique</span>(filled.dat$interval))

filled.max.int&lt;-filled.means.df[<span class="kw">which.max</span>(filled.means.df$Steps),]

filled.pplt&lt;-<span class="kw">ggplot</span>(filled.means.df,<span class="kw">aes</span>(<span class="dt">x=</span>Interval,<span class="dt">y=</span>Steps))
filled.pplt+<span class="kw">geom_line</span>()+
<span class="st">  </span><span class="kw">scale_x_datetime</span>(<span class="dt">labels =</span> <span class="kw">date_format</span>(<span class="st">&quot;%H:%M&quot;</span>))+
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Time of Day&quot;</span>)+
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Average Number of Steps&quot;</span>)+
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Average Daily Pattern: After Filling Missing Values&quot;</span>)+
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">colour=</span><span class="st">&quot;Max&quot;</span>,<span class="dt">linetype=</span><span class="st">&quot;Max&quot;</span>),<span class="dt">xintercept=</span><span class="kw">as.numeric</span>(filled.max.int[<span class="dv">1</span>,<span class="dv">1</span>]),<span class="dt">colour=</span><span class="st">&#39;red&#39;</span>,<span class="dt">linetype=</span><span class="st">&quot;longdash&quot;</span>)+
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="dt">label=</span><span class="kw">format</span>(filled.max.int[<span class="dv">1</span>,<span class="dv">1</span>],<span class="st">&quot;%H:%M&quot;</span>),<span class="dt">x=</span>filled.max.int[<span class="dv">1</span>,<span class="dv">1</span>],<span class="dt">y=</span><span class="dv">20</span>,<span class="dt">angle=</span><span class="dv">90</span>,<span class="dt">vjust=</span>-.<span class="dv">5</span>,<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>,<span class="dt">size=</span><span class="dv">4</span>)</code></pre>
<p><img src="PA1_template_files/figure-html/filled_daily_pattern.png" title="plot of chunk filled_daily_pattern" alt="plot of chunk filled_daily_pattern" width="768" /></p>
<p>Finally, comparing to the calendar view, it is interesting to note that the remaining dates with low step counts appear to occur at a fairly regular frequency.</p>
<pre class="sourceCode r"><code class="sourceCode r">filled.hplt+<span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Date,<span class="dt">y=</span>Steps),<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)+
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Total Steps Per Day: After Filling Missing Values&#39;</span>)</code></pre>
<p><img src="PA1_template_files/figure-html/filled_calendar.png" title="plot of chunk filled_calendar" alt="plot of chunk filled_calendar" width="768" /></p>
</div>
<div id="are-there-differences-in-activity-patterns-between-weekdays-and-weekends" class="section level2">
<h2>Are there differences in activity patterns between weekdays and weekends?</h2>
<p>Using the filled dataset from the previous section, we can compare average activity patterns between weekends and weekdays.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># add a weekend column to the filled dataset</span>
filled.dat$weekend&lt;-<span class="kw">sapply</span>(filled.dat$wday, <span class="dt">FUN=</span>function(x) <span class="kw">ifelse</span>(x %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Sat&#39;</span>,<span class="st">&#39;Sun&#39;</span>), <span class="dv">1</span>, <span class="dv">0</span>))
<span class="co"># now calculate the means for each interval, for both weekend and weekdays</span>
weekday.means.df&lt;-<span class="kw">data.frame</span>(<span class="dt">Interval=</span><span class="kw">unique</span>(filled.dat$tod), <span class="dt">Steps=</span><span class="kw">sapply</span>(<span class="kw">unique</span>(filled.dat$interval),<span class="dt">FUN=</span>function(x) <span class="kw">mean</span>(filled.dat[filled.dat$interval==x &amp;<span class="st"> </span>filled.dat$weekend==<span class="dv">0</span>,<span class="st">&#39;steps&#39;</span>],<span class="dt">na.rm=</span><span class="ot">TRUE</span>)),<span class="dt">int=</span><span class="kw">unique</span>(filled.dat$interval),<span class="dt">weekend=</span><span class="dv">0</span>)

weekend.means.df&lt;-<span class="kw">data.frame</span>(<span class="dt">Interval=</span><span class="kw">unique</span>(filled.dat$tod), 
      <span class="dt">Steps=</span><span class="kw">sapply</span>(<span class="kw">unique</span>(filled.dat$interval),<span class="dt">FUN=</span>function(x) <span class="kw">mean</span>(filled.dat[filled.dat$interval==x &amp;<span class="st"> </span>filled.dat$weekend==<span class="dv">1</span>,<span class="st">&#39;steps&#39;</span>],<span class="dt">na.rm=</span><span class="ot">TRUE</span>)),
      <span class="dt">int=</span><span class="kw">unique</span>(filled.dat$interval),<span class="dt">weekend=</span><span class="dv">1</span>)
<span class="co"># combine the two dataframes</span>
filled.means.df&lt;-<span class="kw">rbind</span>(weekday.means.df,weekend.means.df)
filled.means.df$weekend&lt;-<span class="kw">factor</span>(filled.means.df$weekend,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Weekdays&quot;</span>,<span class="st">&quot;Weekends&quot;</span>))

filled.pplt&lt;-<span class="kw">ggplot</span>(filled.means.df,<span class="kw">aes</span>(<span class="dt">x=</span>Interval,<span class="dt">y=</span>Steps))
filled.pplt+<span class="kw">geom_line</span>()+
<span class="st">  </span><span class="kw">scale_x_datetime</span>(<span class="dt">labels =</span> <span class="kw">date_format</span>(<span class="st">&quot;%H:%M&quot;</span>))+<span class="kw">xlab</span>(<span class="st">&quot;Time of Day&quot;</span>)+
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Average Number of Steps&quot;</span>)+
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Average Daily Pattern: Weekdays vs Weekends&quot;</span>)+
<span class="st">  </span><span class="kw">facet_grid</span>(weekend~.)</code></pre>
<p><img src="PA1_template_files/figure-html/weekends.png" title="plot of chunk weekends" alt="plot of chunk weekends" width="768" /></p>
<p>A comparison of the two traces would seem to support the conclusion that the subject slept in more often on weekends and sometimes skipped their morning exercise session, however they were more likely to be active throughout the waking hours. On weekdays, the alarm clock appears to ring before 6 AM.</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with --self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
